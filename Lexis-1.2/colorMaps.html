<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Lexis: Color maps</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lexis
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
   <div id="projectbrief">Vocabulary of events and shared objects for BBP and HBP software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('colorMaps.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Color maps </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Being able to specify a mapping between scalar variables and parameters used for represent visually those variable is a recurring theme in visualization applications. An exemplary case is the transfer functions that map density to RGBA and opacity values in volume rendering with an emission-absorption optical model.</p>
<p>This specification describes the messages to deal with maps as a particular case of transfer function (TF). The more generic case will be addressed in a separate document.</p>
<p>This document follows the discussion initiated in by [<a href="https://github.com/HBPVIS/Lexis/pull/19">https://github.com/HBPVIS/Lexis/pull/19</a>]</p>
<h2>Requirements</h2>
<ul>
<li>Represent RGBA color maps with an independent TF for each channel. The basic TF definition should be reusable for the more generic case.</li>
<li>Represent extra material properties such as light emission and contribution.</li>
<li>The network representation shouldn't restrict the options in the implementation of a GUI editor.</li>
</ul>
<h2>Discussion</h2>
<p>Defining a color map with control points only makes sense if the application shader is capable of computing its values at runtime. In other words, the shader has to be able to compute any value that resolves the linear/Gaussian/etc function defined by control points. That (heavy and incompatible with real-time rendering) computation has to be implemented for all technologies used by the shaders (currently c++, glsl, cuda, ispc, etc). If generalization is wanted in the form of a method of the color map event (implemented in C++), that method has to compute the transformation from the control points to a lookup table in order to feed the shaders. And in that case, why not simply expose the color map as a simple lookup table, and leave the control point management to the client application?</p>
<h3>Why lookup tables?</h3>
<h4>Pros</h4>
<ul>
<li>Generated by the UI.</li>
<li>Used as is by the rendering engines, avoiding any kind of transformation in various technologies. Precision is defined by the sampling.</li>
<li>More suitable for real-time rendering since value are precomputed</li>
</ul>
<h4>Cons</h4>
<ul>
<li>Not as accurate as control point since the precision depends on the sampling rate</li>
</ul>
<h3>Why control points?</h3>
<h4>Pros</h4>
<ul>
<li>Precision is infinite if the application can handle them, otherwise a single C++ implementation in the event does the job but looses the interest of using control points.</li>
<li>Convenient for the UI.</li>
</ul>
<h4>Cons</h4>
<ul>
<li>A lookup table is still required for convenience with existing (python or JavaScript) client libraries.</li>
<li>Sending control points is not enough to define the transfer function. Other information such as tangents and type of algorithm (guassian, linear, etc) also need to be communicated to the renderer.</li>
</ul>
<h3>State owner</h3>
<p>The UI holds the state of the transfer function, and overwrites any value held by the renderer.</p>
<h3>To summarize</h3>
<ul>
<li>The transfer function event is a set a lookup table (RGBA, and extra attributes) with variable lengths and a range of values to which the lookup table is applied.</li>
<li>The size of the lookup table determines the precision of the sampling.</li>
<li>The UI (or any client in general) is responsible for the state of the color map.</li>
<li>The UI is responsible for generating the lookup tables, as well as the sampling rate according to its own capabilities (Control points, mathematical functions, custom color maps, etc).</li>
</ul>
<h2>Design</h2>
<p>A simple event defines a range and a transfer function for each 'channel'. In our case, channels are the diffuse color, the opacity (alpha), the light emission, and the contribution to the geometry (how much of the geometry material is impacted by the transfer function). Each lookup table can have a variable number of values.</p>
<h3>Message</h3>
<pre class="fragment">namespace lexis.render;

table Color
{
    red: float; // [0..1]
    green: float; // [0..1]
    blue: float; // [0..1]
}

table MaterialLUT
{
    range: [double:2]; // Range of value to which the color map should apply
    diffuse: [Color]; // Diffuse color
    emission: [Color]; // Light emission
    alpha: [float]; // Opacity [0..1]
    contribution: [float]; // Contribution rate to the existing surface
                              material [0..1]
}</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="Features.html">Feature specifications</a></li>
    <li class="footer">Generated on Thu Oct 26 2017 03:19:55 for Lexis by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
